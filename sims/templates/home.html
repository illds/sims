{% extends "layout.html" %}
{% block content %}
    <h1 class="text-center border-bottom">Sims Map</h1>
    <div id="plot-container" class="border border-dark"></div>
    <script>
        // –°–æ–∑–¥–∞–µ–º –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω—É—é –ø–ª–æ—Å–∫–æ—Å—Ç—å —Å –ø–æ–º–æ—â—å—é D3.js
        const width = 1000;
        const height = 500;

        const svg = d3.select("#plot-container")
            .append("svg")
            .attr("width", width)
            .attr("height", height);

        // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫–∏ –∏ –∏–º–µ–Ω–∞ –ª—é–¥–µ–π (humans) –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ü–∏–∫–ª–∞ for
        {% for human in humans %}
            const human{{ human.id }} = svg.append("circle")
                .attr("cx", width / 2 + {{ human.x }})
                .attr("cy", height / 2 - {{ human.y }})
                .attr("r", 8)
                .attr("fill", "green")
                .attr("class", "human-point")
                .on("click", function () {
                    const url = "{{ url_for('humans.human', human_id=human.id) }}";
                    window.location.href = url;
                });

            svg.append("text")
                .attr("x", width / 2 + {{ human.x }})
                .attr("y", height / 2 - {{ human.y }})
                .text("{{ human.name }}")
                .attr("fill", "black")
                .style("font-size", "10px")
                .on("click", function () {
                    const url = "{{ url_for('humans.human', human_id=human.id) }}";
                    window.location.href = url;
                });
        {% endfor %}

        {% for pet in pets %}
            const pet{{ pet.id }} = svg.append("circle")
                .attr("cx", width / 2 + {{ pet.x }})
                .attr("cy", height / 2 - {{ pet.y }})
                .attr("r", 5)
                .attr("fill", "red")
                .attr("class", "pet-point")
                .on("click", function () {
                    const url = "{{ url_for('pets.pet', pet_id=pet.id) }}";
                    window.location.href = url;
                });

            svg.append("text")
                .attr("x", width / 2 + {{ pet.x }})
                .attr("y", height / 2 - {{ pet.y }})
                .text("{{ pet.name }}")
                .attr("fill", "black")
                .style("font-size", "10px")
                .on("click", function () {
                    const url = "{{ url_for('pets.pet', pet_id=pet.id) }}";
                    window.location.href = url;
                });
        {% endfor %}

        {% for house in houses %}
            {#const house{{ house.id }} = svg.append("rect")#}
            {#    .attr("x", width / 2 + {{ house.x }})#}
            {#    .attr("y", height / 2 - {{ house.y }})#}
            {#    .attr("width", 30)#}
            {#    .attr("height", 30)#}
            {#    .attr("fill", "grey")#}
            {#    .attr("class", "house-point")#}
            {#    .on("click", function () {#}
            {#        const url = "{{ url_for('houses.house', house_id=house.id) }}";#}
            {#        window.location.href = url;#}
            {#    });#}

            svg.append("text")
                .attr("x", width / 2 + {{ house.x }})
                .attr("y", height / 2 - {{ house.y }})
                .text("üè†Ô∏é")
                .attr("fill", "black")
                .style("font-size", "20px")
                .on("click", function () {
                    const url = "{{ url_for('houses.house', house_id=house.id) }}";
                    window.location.href = url;
                });

            svg.append("text")
                .attr("x", width / 2 + {{ house.x }} - 5)
                .attr("y", height / 2 - {{ house.y }} - 20)
                .text("House")
                .attr("fill", "black")
                .style("font-size", "10px")
                .on("click", function () {
                    const url = "{{ url_for('houses.house', house_id=house.id) }}";
                    window.location.href = url;
                });
        {% endfor %}
    </script>
    <div class="mt-3 text-center">
        <a href="{{ url_for('humans.new_human') }}" class="btn btn-success mb-2">New Human</a>
        <a href="{{ url_for('pets.new_pet') }}" class="btn btn-success mb-2">New Pet</a>
        <a href="{{ url_for('houses.new_house') }}" class="btn btn-success mb-2">New House</a>
        <a href="{{ url_for('families.new_family') }}" class="btn btn-success mb-2">New Family</a>
        <br>
        <a href="{{ url_for('families.all_families') }}" class="btn btn-info mb-2">All Families</a>
    </div>
{% endblock content %}
